<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.cardGGaduekMainService.store.mapper.StoreMapper">
    <resultMap id="storeMap" type="org.cardGGaduekMainService.store.domain.StoreVO">
        <result column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="address" property="address"/>
        <result column="latitude" property="latitude"/>
        <result column="longitude" property="longitude"/>
        <result column="open_time" property="openTime"/>
        <result column="close_time" property="closeTime"/>
    </resultMap>
    <select id="getStores" resultType="org.cardGGaduekMainService.store.domain.StoreVO">
        SELECT id, name, address, latitude, longitude, open_time, close_time
        FROM store
        WHERE 1=1
        <if test="keyword != null and keyword !=''">
            AND name LIKE CONCAT('%',#{keyword}, '%')
        </if>
        <if test="categoryId != null">
            AND category_id = #{categoryId}
        </if>
<!--        <if test="latitude != null and longitude != null and radius != null">-->
<!--            AND (6371 * ACOS(COS(RADIANS(#{latitude})) * COS(RADIANS(latitude)) *-->
<!--            COS(RADIANS(longitude) - RADIANS(#{longitude})) +-->
<!--            SIN(RADIANS(#{latitude})) * SIN(RADIANS(latitude)))-->
<!--        </if>-->
<!--        Having distance <-->
        ORDER BY name ASC
    </select>
</mapper>
